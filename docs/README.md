# Документация

## Конфигурация сервера

Вся конфигурация выполняется в одном файле: `serverConfig.py`

### Объяснение назначения переменных

+ `SERVER_ON_PORT` - порт, на котором работает сервер. Обычно применяется, когда сервер переходит на TLS/SSL;
+ `USE_SSL` - включает поддержку SSL;
    + Если используется SSL, требуется указать:
        + `SSL_KEYFILE` - путь до файла ключей сертификата;
        + `SSL_CERTFILE` - путь до самого сертификата;

## Задаем расположения публикуемых файлов

+ `SITE_DIR` - переменная пути до файлов сервера-сайта. Все указанные пути к файлам в словарях ниже будут ссылаться на файлы в этой папке;
+ `SITE_ERROR_FILES` - словарь с путями к HTML страницам HTTP ошибок. Имеет следующий вид:

```python
{
    "<код HTTP ошибки>": ("<MIME тип содержимого>", "<путь до HTML файла>")
}
```

+ `SITE_STRUCTURE` - словарь с путями до файлов.

```python
{
    "<HTTP метод>": {
        "<URL>": ("<тип представления>", *<аргументы>)
    }
}
```

+ Если тип `file` - `"<MIME тип содержимого>", "<путь до локального файла>"`
+ Если тип `redirection` - `"<адрес в сети или URL>"`
+ Если тип `function` - `"<функция обработки запроса>"`

Подробное объяснение представлено ниже.

### Добавление файлов

Здесь все довольно просто. В словарь `SITE_STRUCTURE`, в словарь метода `GET` требуется добавить элемент, в кортеже указать тип представления как `file`, указать MIME-тип файла и путь до локального файла. Желательно добавлять по такому принципу: в `serverConfig.py` в словаре `SITE_STRUCTURE` создать словари с методами, которые в дальнейшем будут использоваться, а в `view.py` прописать такие строки:
```python
...
import serverConfig
...
# Словарь адресов и путей файлов
urls_GET = {
    "/index.html": ("file", "text/html;charset=utf-8", "index.html")
}
...
# Обновляем словарь в serverConfig.py
serverConfig.SITE_STRUCTURE["GET"].update(urls_GET)
```

### Создание редиректов (перенаправлений)

Создание редиректов еще проще. Делаем все тоже самое что и с файлами, только тип представления будет `redirection` и стоит только указать путь до файла/страницы/сайта как аргумент.

### Добавление функций

Свои функции обработки запроса следует размещать в файле `view.py` (можно и в других, тогда следует сделать импортирование `serverConfig`).

Пример:

```python
# view.py
from pageEngine import generateCustomAnswer


def about():
    # Можно добавить два аргумента в функцию и получить запросы HEAD и BODY
    send_data = "<h1>About</h1>".encode()  # Данные обязательно должны конвертированы в строке байтов

    return generateCustomAnswer(content_type="text/html", data=send_data)

...

urls_GET = {
    "/about": ("function", about)
}

# Добавляем функцию в структуру сайта в соответствии с нужным методом HTTP
# (GET, POST, ...) для дальнейшей обработки сервером
serverConfig.SITE_STRUCTURE["GET"].update(urls_GET)
```

После перезапуска сервера, появится новая страница по адресу `/about`.
